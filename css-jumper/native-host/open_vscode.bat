@echo off
powershell -NoProfile -ExecutionPolicy Bypass -Command "& { $input_stream = [Console]::OpenStandardInput(); $len_buf = New-Object byte[] 4; $input_stream.Read($len_buf, 0, 4) | Out-Null; $msg_len = [BitConverter]::ToUInt32($len_buf, 0); $msg_buf = New-Object byte[] $msg_len; $input_stream.Read($msg_buf, 0, $msg_len) | Out-Null; $json = [Text.Encoding]::UTF8.GetString($msg_buf) | ConvertFrom-Json; $file = $json.file; $line = $json.line; Start-Process cmd -ArgumentList '/c', ('code --goto \"' + $file + ':' + $line + '\"') -WindowStyle Hidden; $resp = [Text.Encoding]::UTF8.GetBytes('{\"success\":true}'); $resp_len = [BitConverter]::GetBytes([uint32]$resp.Length); $output_stream = [Console]::OpenStandardOutput(); $output_stream.Write($resp_len, 0, 4); $output_stream.Write($resp, 0, $resp.Length); $output_stream.Flush() }"
